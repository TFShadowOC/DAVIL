<!DOCTYPE html>
<html lang="en">
<head>
    <title>Ma<3isYOURS</title>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>

    <div class="heart"></div>
      <audio id="music" src="BMTH-FY.mp3"></audio>


</body>
    <script>
   const heart = document.querySelector('.heart');
const audio = document.getElementById('music');

const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
const analyser = audioCtx.createAnalyser();
analyser.fftSize = 256;

const source = audioCtx.createMediaElementSource(audio);
source.connect(analyser);
analyser.connect(audioCtx.destination);

const dataArray = new Uint8Array(analyser.frequencyBinCount);

let lastBeat = 425;
const cooldown = 850; //ms
const beatThreshold = 120; 

function animateHeart() {
  analyser.getByteFrequencyData(dataArray);

  const maxFrequency = Math.max(...dataArray);

  const now = Date.now();
  if (maxFrequency > beatThreshold && now - lastBeat > cooldown) {
    heart.classList.remove('beat-once');
    void heart.offsetWidth;
    heart.classList.add('beat-once');
    lastBeat = now;
  }

  requestAnimationFrame(animateHeart);
}

heart.addEventListener('click', () => {
  if (audio.paused) {
    audioCtx.resume();
    audio.play();
    animateHeart(); 
  } else {
    audio.pause();
  }
});
  </script>  
</html>
